{"version":3,"sources":["static/css/minesweeper.module.css","static/img/minesweeper/games_sapper-cell.png","components/games/Minesweeper.js","static/img/minesweeper/games_sapper-flag.png","static/img/minesweeper/games_sapper-bomb.png","static/img/minesweeper/games_sapper-clear.png","components/parts/Scoreboard.js","static/css/score.module.css","components/parts/Alert.js","static/css/alert.module.css","components/parts/Ruler.js","components/parts/InfoBlock.js","static/css/canvas.module.css"],"names":["module","exports","Tictactoe","props","displayPoint","x","y","value","ctx","canvas","current","getContext","font","undefined","board","gameInfo","boardSizeX","cellFlagIcon","Image","src","onload","drawImage","cellClosedIcon","IconClosed","cellBombIcon","cellOpenedIcon","fillStyle","fillText","clear","clearRect","boardSizeY","strokeStyle","lineWidth","beginPath","i","j","action","e","typeClick","preventDefault","paused","rect","getBoundingClientRect","clientX","left","clientY","top","coord","state","actionTypeDefuse","hasOwnProperty","emitter","emit","cell","score","alertValue","React","createRef","this","players","forEach","player","index","userId","localStorage","getItem","playerNumber","emitterUnsubGame","sub","data","type","setState","prevState","newScore","Object","assign","roundStarted","updateScore","currentPlayer","userName","cells","conterCells","keys","length","Number","countCells","savedData","parsedSavedData","JSON","parse","scoreSum","item","setItem","stringify","Scoreboard","displayCurrentPlayer","scoreItemNames","InfoBlock","className","styles","info","roundsForWin","minesCount","Alert","sapperStyle","button","highlite","onClick","ref","onContextMenu","width","height","Ruler","ruler","ruler24","countX","countY","Component","getPlayersList","sortedPlayersArray","queue","numberInQueue","push","Array","prototype","apply","map","style","color","connected","prop","timeleft","timeTurn","lasttime","Date","now","playerTurnTimer","setInterval","newTimeleft","clearInterval","scoreColor","itemName","scoreCurrentPlayer","currentPlayerTurn","backgroundColor","shouldComponentUpdate","nextProps","alertDisplay","alertTimeoutDestroy","clearTimeout","setTimeout","forceUpdate","alertHide","alert","getListByLength","section"],"mappings":"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","file":"static/js/6.39660dc6.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"minesweeper_button__3nJtR\",\"highlite\":\"minesweeper_highlite__2SRZT\"};","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAf0lEQVRIie3XIQ7AIAyF4Y7MzO10OymHQaIgQS8ZpulSEhI2N0Fn3m8RX0A9FhGhnLOQcbXWy1mjmsIhhM0c7zAz0/o+TClNxUspDdbMb97hX/Ax4MCBAwcOHDhw4MA/9djtOujHXT07N8L9J2GV897vf8Bae/YY48HMp6lMRDfopUuKB+qM/QAAAABJRU5ErkJggg==\"","import React from 'react'\r\nimport Scoreboard from '../parts/Scoreboard'\r\nimport Alert from '../parts/Alert'\r\nimport Ruler from '../parts/Ruler'\r\nimport InfoBlock from '../parts/InfoBlock'\r\n\r\nimport styles from '../../static/css/canvas.module.css'\r\nimport sapperStyle from '../../static/css/minesweeper.module.css'\r\n\r\nimport IconClosed from '../../static/img/minesweeper/games_sapper-cell.png'\r\nimport IconOpened from '../../static/img/minesweeper/games_sapper-clear.png'\r\nimport IconFlag from '../../static/img/minesweeper/games_sapper-flag.png'\r\nimport IconBomb from '../../static/img/minesweeper/games_sapper-bomb.png'\r\n\r\nexport default class Tictactoe extends React.Component {\r\n  constructor(props) {\r\n    super(props) \r\n    this.state = {\r\n      score: props.gameInfo.score,\r\n      alertValue: \"\", \r\n      actionTypeDefuse: true\r\n    }\r\n    this.canvas = React.createRef()\r\n  }\r\n  componentWillMount() {\r\n    this.paused = this.props.gameInfo.paused\r\n    this.board = {}\r\n    this.props.players.forEach((player, index) => player.userId===localStorage.getItem('userId')?this.playerNumber = index:null)\r\n    \r\n    this.emitterUnsubGame = this.props.emitter.sub('game', data => {\r\n      switch(data.type) {\r\n        case 'roundStarted': \r\n          this.setState(prevState=>{\r\n            const newScore = Object.assign(prevState.score)\r\n            for(let index in prevState.score) {\r\n              newScore[index][1]=0\r\n            }\r\n            return {\r\n              roundStarted: data.roundStarted,\r\n              score: newScore,\r\n              alertValue: `Раунд начинается!`\r\n            }\r\n          })\r\n          this.paused = false\r\n          this.board = {}\r\n          this.clear()\r\n          break\r\n        case 'roundFinished': {\r\n            this.paused = true\r\n            const updateScore = this.state.score[data.currentPlayer][0]+1\r\n            this.setState(prevState => ({\r\n                score: {...prevState.score, ...updateScore},\r\n                alertValue: `Раунд завершён! Победил ${this.props.players[data.currentPlayer].userName}`\r\n            }))\r\n          break\r\n        }\r\n        case 'openedCells': {\r\n          for (let cell in data.cells) {\r\n            this.displayPoint(cell%this.props.gameInfo.boardSizeX, ~~(cell/this.props.gameInfo.boardSizeX), data.cells[cell])\r\n          }\r\n          const conterCells = this.state.score[this.playerNumber][1]+Object.keys(data.cells).length\r\n          this.setState(prevState => {\r\n            const newScore = Object.assign(prevState.score)\r\n            newScore[this.playerNumber][1]=conterCells\r\n            return {score: newScore}\r\n          })\r\n          break\r\n        }\r\n        case 'explode': \r\n          if (this.playerNumber===Number(data.currentPlayer)) this.displayPoint(data.cell%this.props.gameInfo.boardSizeX, ~~(data.cell/this.props.gameInfo.boardSizeX), 9)\r\n          this.setState({alertValue: `${this.props.players[data.currentPlayer].userName} взорвался`})\r\n          break\r\n        case 'progress': {\r\n        const conterCells = this.state.score[data.currentPlayer][1]+data.countCells\r\n        this.setState(prevState =>  {\r\n          const newScore = Object.assign(prevState.score)\r\n          newScore[data.currentPlayer][1]=conterCells\r\n          return {score: newScore}})\r\n          break \r\n        }\r\n        case 'error': \r\n          break\r\n        case 'matchFinished': \r\n          this.setState({alertValue: `Матч завершён. Победил ${this.props.players[Number(data.currentPlayer)].userName}`})\r\n          break\r\n        default: break\r\n      }\r\n    })\r\n  }\r\n  componentDidMount() {\r\n    this.clear()\r\n    const savedData = localStorage.getItem('sapperData')\r\n    //Получение сохранённого состояния поля\r\n    if (!savedData===\"\") {\r\n      const parsedSavedData = JSON.parse(savedData)\r\n      let scoreSum = 0\r\n      for (let item in this.state.score) {\r\n        scoreSum+=this.state.score[item][0]\r\n      }\r\n      if (parsedSavedData.scoreSum===scoreSum) {\r\n        for (let cell in parsedSavedData.board) {\r\n          this.displayPoint(cell%this.props.gameInfo.boardSizeX, ~~(cell/this.props.gameInfo.boardSizeX), parsedSavedData.board[cell])\r\n          \r\n        }\r\n      } else {}\r\n    }\r\n  }\r\n  componentWillUnmount() {\r\n    //Сохранение текущего состояния поля на случай вылета\r\n    let scoreSum = 0 \r\n    for (let item in this.state.score) {\r\n      scoreSum+=this.state.score[item][0]\r\n    }\r\n    const savedData = {scoreSum, board: this.board}\r\n    localStorage.setItem('sapperData', JSON.stringify(savedData))\r\n    this.emitterUnsubGame()\r\n  }\r\n\r\n  displayPoint = (x, y, value) => {\r\n    const ctx = this.canvas.current.getContext('2d')\r\n    ctx.font = \"800 24px inter\"\r\n    if (value!==undefined) this.board[this.props.gameInfo.boardSizeX*y + x] = value\r\n    switch (value) {\r\n      case -1: { //highlight the bomb\r\n        const cellFlagIcon = new Image()\r\n        cellFlagIcon.src = IconFlag\r\n        cellFlagIcon.onload = () => {\r\n          ctx.drawImage(cellFlagIcon, 1, 1, 30, 30,  x*25, y*25, 25, 25)\r\n        }\r\n        break}\r\n      case undefined: { //clear a cell\r\n        const cellClosedIcon = new Image()\r\n        cellClosedIcon.src = IconClosed\r\n        cellClosedIcon.onload = () => {\r\n          ctx.drawImage(cellClosedIcon, 1, 1, 30, 30,  x*25, y*25, 25, 25)\r\n          delete this.board[this.props.gameInfo.boardSizeX*y + x]\r\n        }\r\n        break}\r\n      case 9: { \r\n        const cellBombIcon = new Image()\r\n        cellBombIcon.src = IconBomb\r\n        cellBombIcon.onload = () => {\r\n          ctx.drawImage(cellBombIcon, 1, 1, 30, 30,  x*25, y*25, 25, 25)\r\n        }\r\n        break}\r\n      default: break\r\n    }\r\n    if (value>=0&&value<9) {\r\n      const cellOpenedIcon = new Image()\r\n      cellOpenedIcon.src = IconOpened\r\n      cellOpenedIcon.onload = () => {\r\n        switch (value) {\r\n          case 1: ctx.fillStyle=\"blue\"; break\r\n          case 2: ctx.fillStyle=\"green\"; break\r\n          case 3: ctx.fillStyle=\"red\"; break\r\n          case 4: ctx.fillStyle=\"blue\"; break\r\n          case 5: ctx.fillStyle=\"brown\"; break\r\n          case 6: ctx.fillStyle=\"aqua\"; break\r\n          case 7: ctx.fillStyle=\"yellow\"; break\r\n          case 8: ctx.fillStyle=\"brown\"; break\r\n          default: break\r\n        }\r\n        ctx.drawImage(cellOpenedIcon, 1, 1, 30, 30, x*25, y*25, 25, 25)\r\n        if (value>0) ctx.fillText(value, x*25+5, y*25+22)\r\n      }\r\n    }\r\n  }\r\n  clear = () => {\r\n    const cellClosedIcon = new Image()\r\n    cellClosedIcon.src = IconClosed\r\n    cellClosedIcon.onload = () => {\r\n      const ctx = this.canvas.current.getContext('2d')\r\n      ctx.clearRect(0,0,(this.props.gameInfo.boardSizeX+1)*25, (this.props.gameInfo.boardSizeY+1)*25)\r\n      ctx.strokeStyle = '#000'\r\n      ctx.lineWidth = 1\r\n      ctx.beginPath();\r\n      for(let i = 0; i < this.props.gameInfo.boardSizeX; i++) {\r\n        for (let j = 0; j <this.props.gameInfo.boardSizeY; j++) {\r\n          ctx.drawImage(cellClosedIcon, 1, 1, 30,30, i*25, j*25, 25, 25)\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n  action = (e, typeClick) => {\r\n    e.preventDefault()\r\n    if (this.paused) return\r\n    const rect = this.canvas.current.getBoundingClientRect()\r\n    const x = ~~((e.clientX - rect.left)/25)\r\n    const y = ~~((e.clientY - rect.top)/25)\r\n    const coord = y*this.props.gameInfo.boardSizeX+x\r\n    if (this.state.actionTypeDefuse&&typeClick===\"left\") {\r\n      if (!this.board.hasOwnProperty(coord)) {\r\n        this.props.emitter.emit('action', {cell: coord})\r\n      }\r\n    } else {//Пометить ячейку как заминированную\r\n      if (this.board[coord]===undefined||this.board[coord]===-1) this.displayPoint(x, y, this.board[coord]===-1?undefined: -1)\r\n    }\r\n  }\r\n  render() {\r\n      return (\r\n            <>\r\n              <Scoreboard displayCurrentPlayer={false}\r\n                paused={this.paused}\r\n                players={this.props.players} \r\n                playerNumber={this.playerNumber} \r\n                score={this.state.score}\r\n                scoreItemNames={['Счёт', 'Прогресс']}\r\n              />\r\n              \r\n              <InfoBlock className={styles.info} \r\n                data={[\r\n                  ['Раундов', this.props.gameInfo.roundsForWin], \r\n                  ['Высота поля', this.props.gameInfo.boardSizeX], \r\n                  ['Ширина поля', this.props.gameInfo.boardSizeX], \r\n                  ['Количество мин', this.props.gameInfo.minesCount], \r\n                ]}\r\n              />\r\n              <Alert value={this.state.alertValue} />\r\n              <div className={`${sapperStyle.button} ${this.state.actionTypeDefuse?\"\":sapperStyle.highlite}`} \r\n                onClick={() => this.setState({actionTypeDefuse: this.state.actionTypeDefuse?false:true})} >\r\n              </div>\r\n              <div className={styles.canvas}>\r\n                <canvas ref={this.canvas} \r\n                  onClick={(e) => this.action(e, \"left\")} \r\n                  onContextMenu={(e) => this.action(e, \"right\")} \r\n                  width={(+this.props.gameInfo.boardSizeX)*25+1} \r\n                  height={(+this.props.gameInfo.boardSizeY)*25+1}>\r\n                </canvas> \r\n                <Ruler className={`${styles.ruler} ${styles.ruler24}`}  \r\n                  countX={this.props.gameInfo.boardSizeX} \r\n                  countY={this.props.gameInfo.boardSizeY}\r\n                  />\r\n              </div>\r\n            </>\r\n      )\r\n  }\r\n}\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAAAsSAAALEgHS3X78AAABd0lEQVRIie2XTWqDQBSAn2lDUxpL1zmAB8gpssgmSz2AF/ACWXSbC3gB9/EcpotuxHWYARfpQttYi0x5A8rUYHVEJxT6wSD+fu/Nc+SpMcaAUspAMVmWnSeqpQiKwzC8Vy4vxUVRwG39JCFkVHkcx1yMKM+8FF9FLvI35TeEwMNuB4+O01t+8cK1MfN9uPN9mB4O/Mqv5XJcOWY58zwu1tK0t0xKXs9yaBprriUJTINgNDH8Jme6Dsl2C2/7PXyu12rlJcViUQVxNk1g87k6uRjEu+PAyffhw7YHCUJ6nWM5UI5BvKxW8Hw89pZLr3MxiHizgdc47i3//7ZfBamaY6NBKa32oyiCNE0hCILqmK7rYBhGp+ddNJBNnYzrunx0wTRNsG2bB1JHDL512jE7y7I6ixHP8/g94oxIZy6TbRP1WWjNvE+2TZSzgM+s07nmQyFV8zH5sdSwoRf76rGZiOLyT0IVXJ7n+Um1mIMvHCHkCbdKB2PwDSCFMkRtlBlEAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAAAsSAAALEgHS3X78AAABx0lEQVRIic2XsUrEQBCGRz0EA4IgCrG5E2zUUsRS8A0EC30DmysOG30CbeSKa3wDFRSb1IKliKUKInhaGFAEQYggSOSPbticmczeLlz8Yclebma/3WR3ZtIXxzEFQRBTCaoopO/7PaWHYUj9LgN49w9Js1XF2pOIRs4vkms0WbXyd1q5q1j43PIajZ6eOQMwBsbKEwtv19ep1tpzmgB8MQbGyhP7zl+XFpMrnFVfDYg2fHWT3vMPj+l9djqx020VWL+nKz3n0lEbfH6hqe1dGmoX7+6PWpXutjboc3ys0M74qAE809gUwRBsYAsfSUZwrHggiogadaLH25+GPiPYwscZjvebrlgHFsDp9wlIm9UIbitnuL6rqdnK75v45ihz1BCnVcjMFYAGUF0TB0eZ328L82k4LjW8ZlaOGXUmCQQQFz2trrDe4soRuWwl+YpwLjSaSPI1giNkdiv4OMMhxOovzzPGwxY+kozgSBLXzR2jJwAb2EqJhSS4XgioCSBF5m0k3MN/OlgqSNh8zhUCes5WAYQ7TqogIWbzsXCpEDARV5CI8MuTfWuors7qRtf/Ca/dCkmiNLjtx8IfOAq6XiupXksREX0DvkrG92RdQIoAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAAAsSAAALEgHS3X78AAAATElEQVRIie3XQQ0AIAwEwYNgov4t1FNllEACEiiPXQOTe17LTLl7qqBxSDN7qkeEesXiEzg4ODg4ODg4ODg4+L/4/WrrO71uv9SSJE3MFA8LEhTWNgAAAABJRU5ErkJggg==\"","import React from 'react'\r\nimport styles from '../../static/css/score.module.css'\r\n/*\r\n  displayCurrentPlayer - Выделить текущего игрока\r\n  paused - Останавливает/Включает таймер\r\n  queue - Последовательность игроков к которым применяется\r\n  players - Массив игроков ex: [{\"userId\":\"11\", \"userName\": \"eeee\r\n  currentPlayerTurn - Текщий игрок\r\n  playerNumber - Игрок (не ставить если гость)\r\n  timeTurn - Время на совершение хода \r\n  lasttime - Время начала хода ()\r\n  score - Счёт ex: [[0,0,0], [1,0,0]]\r\n  scoreItemNames - Названия столбцов ex: ['Счёт', 'Осталось', 'Найдено']\r\n*/\r\nexport default class Scoreboard extends React.Component {\r\n  constructor(props) {\r\n    super(props) \r\n    this.state = {\r\n      timeleft: ~~((props.timeTurn + props.lasttime - Date.now())/1000),\r\n    }\r\n    this.playerTurnTimer = undefined\r\n  }\r\n  componentDidMount() {\r\n    //Отображение оставшегося времени у игрока\r\n    if (this.props.displayCurrentPlayer) this.playerTurnTimer = setInterval(() => {\r\n      if (!this.paused) {\r\n        const newTimeleft = ~~((this.props.timeTurn + this.props.lasttime - Date.now())/1000)\r\n        this.setState({timeleft: newTimeleft})\r\n      }\r\n    }, 1000)\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.props.displayCurrentPlayer) clearInterval(this.playerTurnTimer)\r\n  }\r\n  getPlayersList = () => {\r\n    const sortedPlayersArray = []\r\n    if (this.props.queue!==undefined){\r\n      for (let numberInQueue of this.props.queue) {\r\n        sortedPlayersArray.push(this.props.players[numberInQueue])\r\n      }\r\n    } else Array.prototype.push.apply(sortedPlayersArray,this.props.players)\r\n    \r\n    return sortedPlayersArray.map((player, index) => \r\n    <div style={{color: !player.connected?\"rgb(150,150,150)\":this.props.playerNumber===index?\"rgb(255,165,0)\":\"#000\"}}>\r\n      <div>\r\n        <div>{index+1}</div>\r\n        <div>#{player.userId}</div>\r\n        <div>{player.userName}</div>\r\n      </div>\r\n      {this.props.score[index].map(prop=>\r\n      <div>{prop}</div>\r\n      )}\r\n    </div>\r\n    )\r\n  }\r\n  render() {\r\n    const scoreColor = `rgb(${255 - this.state.timeleft/(this.props.timeTurn/1000)*255}, ${this.state.timeleft/(this.props.timeTurn/1000)*200}, 0)`\r\n      return (\r\n              <div className={styles.score}>\r\n                <div>\r\n                  <div>Игроки</div>\r\n                  {this.props.scoreItemNames.map(itemName=>\r\n                    <div>{itemName}</div>\r\n                    )}\r\n                </div>\r\n                {this.props.displayCurrentPlayer?\r\n                <div className={styles.scoreCurrentPlayer} style={{color: scoreColor, top: 30 + this.props.currentPlayerTurn*42+'px', backgroundColor: scoreColor}}>\r\n                  <div>{this.state.timeleft}</div>\r\n                  <div style={{\"border-color\": scoreColor}}></div>\r\n                  <div style={{\"border-color\": scoreColor}}></div>\r\n                </div>\r\n                :<div></div>\r\n                }\r\n                \r\n                {this.getPlayersList()}\r\n              </div>\r\n      )\r\n  }\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"score\":\"score_score__1Slqo\",\"scoreCurrentPlayer\":\"score_scoreCurrentPlayer__36TAD\"};","import React from 'react'\r\nimport styles from '../../static/css/alert.module.css'\r\n\r\nexport default class Alert extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.alertDisplay = false\r\n    this.alertTimeoutDestroy = undefined\r\n  }\r\n  shouldComponentUpdate = (nextProps) => {\r\n    if (nextProps.value===this.props.value) return false\r\n    this.alertDisplay = true\r\n    if (this.alertTimeoutDestroy!==undefined) {\r\n      clearTimeout(this.alertTimeoutDestroy)\r\n    }\r\n    this.alertTimeoutDestroy = setTimeout(() => {\r\n      this.alertDisplay = false\r\n      this.alertTimeoutDestroy = undefined\r\n      this.forceUpdate()\r\n    }, 3000)\r\n    return true\r\n  }\r\n  alertHide = () => {\r\n    clearTimeout(this.alertTimeoutDestroy)\r\n    this.alertDisplay = false\r\n    this.alertTimeoutDestroy = undefined\r\n    this.forceUpdate()\r\n  }\r\n  render() {\r\n    return (\r\n      <div className={`${styles.alert} ${this.alertDisplay?styles.alertDisplay:''}`}>\r\n        <div onClick={this.alertHide}>\r\n          {this.props.value}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"alert\":\"alert_alert__285A5\",\"alertDisplay\":\"alert_alertDisplay__3muLT\"};","import React from 'react'\r\nexport default function Ruler(props) {\r\n  function getListByLength(length) {\r\n    let section = []\r\n    for(let i = 0; i < length; i++) {\r\n      section.push(<li></li>)\r\n    }\r\n    return section\r\n  }\r\n  return (\r\n    <div className={props.className} >\r\n        <ol>\r\n          {getListByLength(props.countX)}\r\n        </ol>\r\n        <ol>\r\n          {getListByLength(props.countY)}\r\n        </ol>\r\n        <div>\r\n          <div></div>\r\n        </div>\r\n        <div></div>\r\n        <div></div>\r\n    </div>\r\n  )\r\n}","import React from 'react'\r\nexport default function InfoBlock(props) {\r\n  return (\r\n    <div className={props.className} >\r\n      {props.data.map(prop => <div><span>{prop[0]}</span><span> {prop[1]}</span></div>) }\r\n    </div>\r\n  )\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"canvas_canvas__1xjwk\",\"ruler\":\"canvas_ruler__3jpTN\",\"info\":\"canvas_info__larj0\",\"ruler24\":\"canvas_ruler24__2YnvR\"};"],"sourceRoot":""}