{"version":3,"sources":["components/parts/CanvasTools.js","static/sound/pencil.mp3","components/games/Tictactoe.js","components/parts/Scoreboard.js","static/css/score.module.css","components/parts/Alert.js","static/css/alert.module.css","components/parts/Ruler.js","components/parts/InfoBlock.js","static/css/canvas.module.css"],"names":["animate","animRenderF","time","animStart","window","requestAnimationFrame","animStep","timestamp","animCurrentTime","Tictactoe","props","displayPoint","value","x","y","animation","ctx","canvas","current","getContext","lineCap","lineWidth","currentBoard","gameInfo","boardSize","turnSound","Audio","soundPencil","play","fillStyle","strokeStyle","clearRect","fillRect","fill","beginPath","coordFirstLine","Math","floor","moveTo","lineTo","coordSecondLine","stroke","arc","PI","clear","i","actionTurn","e","paused","playerNumber","state","currentPlayerTurn","setState","alertValue","rect","getBoundingClientRect","clientX","left","clientY","top","hasOwnProperty","emitter","emit","score","lasttime","players","every","player","index","userId","localStorage","getItem","queue","queuePlayer","queueIndex","React","createRef","this","emitterUnsubGame","sub","data","type","userName","cell","newScore","prevState","nextPlayer","cellNumber","Scoreboard","displayCurrentPlayer","timeTurn","scoreItemNames","InfoBlock","className","styles","info","roundsForWin","cellsForWin","Alert","ref","onClick","width","height","Ruler","ruler","countY","countX","Component","getPlayersList","sortedPlayersArray","undefined","numberInQueue","push","Array","prototype","apply","map","style","color","connected","prop","timeleft","Date","now","playerTurnTimer","setInterval","newTimeleft","clearInterval","scoreColor","itemName","scoreCurrentPlayer","backgroundColor","module","exports","shouldComponentUpdate","nextProps","alertDisplay","alertTimeoutDestroy","clearTimeout","setTimeout","forceUpdate","alertHide","alert","getListByLength","length","section"],"mappings":"oQACA,SAASA,EAAQC,EAAaC,GAC5B,IAAIC,EAAY,KAOhBC,OAAOC,uBANU,SAAXC,EAAWC,GACVJ,IAAWA,EAAUI,GAC1B,IAAMC,EAAkBD,EAAYJ,EACpCF,EAAYO,GACRA,EAAgBN,GAAME,OAAOC,sBAAsBC,MCP5C,UAA0B,mC,iBCUpBG,E,kDACnB,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IAqERC,aAAe,SAACC,EAAOC,EAAGC,GAAwB,IAArBC,EAAoB,wDACzCC,EAAM,EAAKC,OAAOC,QAAQC,WAAW,MAC3CH,EAAII,QAAU,QACdJ,EAAIK,UAAY,EAChB,EAAKC,aAAa,EAAKZ,MAAMa,SAASC,UAAUV,EAAID,GAAKD,EACzD,IAAMa,EAAY,IAAIC,MAAMC,GAE5B,GADAF,EAAUG,QACM,IAAZb,EACF,OAAQH,GACN,KAAK,EACHZ,GAAQ,SAAAO,GACNS,EAAIa,UAAJ,4BAAqCtB,EAAU,IAAKA,EAAU,IAAKA,EAAU,IAAK,GAAGA,EAAU,KAAM,IAAK,EAA1G,KACAS,EAAIc,YAAc,OAClBd,EAAIe,UAAY,GAAFlB,EAAK,EAAK,GAAFC,EAAK,EAAG,GAAI,IAClCE,EAAIgB,SAAW,GAAFnB,EAAK,EAAK,GAAFC,EAAK,EAAG,GAAI,IACjCE,EAAIiB,OACJjB,EAAIkB,YACJ,IAAMC,EAAiBC,KAAKC,OAAO9B,EAAU,IAAIA,EAAU,KAAK,IAGhE,GAFAS,EAAIsB,OAAS,GAAFzB,EAAK,EAAK,GAAFC,EAAK,GACxBE,EAAIuB,OAAS,GAAF1B,EAAK,EAAEsB,EAAkB,GAAFrB,EAAK,EAAEqB,GACrC5B,EAAU,IAAK,CACjB,IAAMiC,EAAkBJ,KAAKC,OAAO9B,EAAU,IAAIA,EAAU,IAAI,KAAK,IACrES,EAAIsB,OAAS,GAAFzB,EAAK,GAAM,GAAFC,EAAK,GACzBE,EAAIuB,OAAS,GAAF1B,EAAK,GAAG2B,EAAmB,GAAF1B,EAAK,EAAE0B,GAE7CxB,EAAIyB,WACH,KACL,MACA,KAAK,EACHzC,GAAQ,SAAAO,GACNS,EAAIa,UAAJ,4BAAqCtB,EAAU,IAAKA,EAAU,IAAKA,EAAU,IAAK,GAAGA,EAAU,KAAM,IAAK,EAA1G,KACAS,EAAIc,YAAc,MAClBd,EAAIe,UAAY,GAAFlB,EAAK,EAAK,GAAFC,EAAK,EAAG,GAAI,IAClCE,EAAIgB,SAAW,GAAFnB,EAAK,EAAK,GAAFC,EAAK,EAAG,GAAI,IACjCE,EAAIiB,OACJjB,EAAIkB,YACJlB,EAAI0B,IAAM,GAAF7B,EAAK,GAAM,GAAFC,EAAK,GAAI,EAAG,GAAGsB,KAAKO,IAAIpC,EAAU,IAAIA,EAAU,IAAI,IAAI,GACzES,EAAIyB,WACH,KACL,MACA,KAAK,EACHzC,GAAQ,SAAAO,GACNS,EAAIa,UAAJ,4BAAqCtB,EAAU,IAAKA,EAAU,IAAKA,EAAU,IAAK,GAAGA,EAAU,KAAM,IAAK,EAA1G,KACAS,EAAIe,UAAY,GAAFlB,EAAK,EAAK,GAAFC,EAAK,EAAG,GAAI,IAClCE,EAAIgB,SAAW,GAAFnB,EAAK,EAAK,GAAFC,EAAK,EAAG,GAAI,IACjCE,EAAIiB,OACJjB,EAAIa,UAAY,QAChBb,EAAIkB,YACJlB,EAAI0B,IAAM,GAAF7B,EAAK,GAAM,GAAFC,EAAK,GAAIP,EAAU,IAAIA,EAAU,GAAG,EAAG,EAAW,EAAR6B,KAAKO,IAAM,GACtE3B,EAAIiB,SACH,UAKP,OAAQrB,GACN,KAAK,EACHI,EAAIkB,YACJlB,EAAIsB,OAAS,GAAFzB,EAAK,EAAK,GAAFC,EAAK,GACxBE,EAAIuB,OAAS,GAAF1B,EAAK,GAAM,GAAFC,EAAK,IACzBE,EAAIsB,OAAS,GAAFzB,EAAK,GAAM,GAAFC,EAAK,GACzBE,EAAIuB,OAAS,GAAF1B,EAAK,EAAK,GAAFC,EAAK,IACxBE,EAAIc,YAAc,OAClBd,EAAIyB,SACN,MACA,KAAK,EACHzB,EAAIkB,YACJlB,EAAI0B,IAAM,GAAF7B,EAAK,GAAM,GAAFC,EAAK,GAAI,EAAG,EAAa,EAAVsB,KAAKO,IAAQ,GAC7C3B,EAAIc,YAAc,MAClBd,EAAIyB,SACN,MACA,KAAK,EACHzB,EAAIkB,YACJlB,EAAI0B,IAAM,GAAF7B,EAAK,GAAM,GAAFC,EAAK,GAAI,EAAG,EAAa,EAAVsB,KAAKO,IAAQ,GAC7C3B,EAAIa,UAAY,QAChBb,EAAIiB,SAjJO,EAuJnBW,MAAQ,WACN,IAAM5B,EAAM,EAAKC,OAAOC,QAAQC,WAAW,MAC3CH,EAAIe,UAAU,EAAE,EAAoC,IAAjC,EAAKrB,MAAMa,SAASC,UAAU,GAAyC,IAAjC,EAAKd,MAAMa,SAASC,UAAU,IACvFR,EAAIc,YAAc,OAClBd,EAAIK,UAAY,EAChBL,EAAIkB,YACJ,IAAI,IAAIW,EAAI,EAAGA,GAAK,EAAKnC,MAAMa,SAASC,UAAWqB,IACjD7B,EAAIsB,OAAS,GAAFO,EAAM,GACjB7B,EAAIuB,OAAS,GAAFM,EAAoC,GAA9B,EAAKnC,MAAMa,SAASC,WAEvC,IAAI,IAAIqB,EAAI,EAAGA,GAAK,EAAKnC,MAAMa,SAASC,UAAWqB,IACjD7B,EAAIsB,OAAO,EAAK,GAAFO,GACd7B,EAAIuB,OAAqC,GAA9B,EAAK7B,MAAMa,SAASC,UAAgB,GAAFqB,GAE/C7B,EAAIyB,UArKa,EAwKnBK,WAAa,SAACC,GACZ,GAAI,EAAKC,QAAQ,EAAKC,eAAe,EAAKC,MAAMC,kBAAmB,OAAO,EAAKC,SAAS,CAACC,WAAY,2IACrG,IAAMC,EAAO,EAAKrC,OAAOC,QAAQqC,wBAC3B1C,MAAQkC,EAAES,QAAUF,EAAKG,MAAM,IAC/B3C,MAAQiC,EAAEW,QAAUJ,EAAKK,KAAK,IAC/B,EAAKrC,aAAasC,eAAe9C,GAAG,EAAKJ,MAAMa,SAASC,UAAUX,GAEhE,EAAKuC,SAAS,CAACC,WAAY,8EADhC,EAAK3C,MAAMmD,QAAQC,KAAK,SAAU,CAACjD,EAAGA,EAAGC,EAAGA,KA5K9C,EAAKoC,MAAQ,CACdC,kBAAmBzC,EAAMa,SAAS4B,kBAC/BY,MAAOrD,EAAMa,SAASwC,MACtBV,WAAY,GACZW,SAAUtD,EAAMa,SAASyC,UAE3B,EAAK1C,aAAeZ,EAAMa,SAASD,aACnC,EAAK0B,OAAStC,EAAMa,SAASyB,OAC7BtC,EAAMuD,QAAQC,OAAM,SAACC,EAAQC,GAAT,OAAmBD,EAAOE,SAAUC,aAAaC,QAAQ,WAAe7D,EAAMa,SAASiD,MAAMN,OAAM,SAACO,EAAaC,GACjI,OAAID,IAAcL,IAClB,EAAKnB,aAAeyB,GACb,SAGX,EAAKzD,OAAS0D,IAAMC,YAhBH,E,iEAkBG,IAAD,OACnBC,KAAKC,iBAAmBD,KAAKnE,MAAMmD,QAAQkB,IAAI,QAAQ,SAAAC,GACrD,OAAOA,EAAKC,MACV,IAAK,eACH,EAAK7B,SAAS,CACZD,kBAAmB6B,EAAK7B,kBACxBa,SAAUgB,EAAKhB,SACfX,WAAW,0HAAD,OAA6B,EAAK3C,MAAMuD,QAAQ,EAAKvD,MAAMa,SAASiD,MAAMQ,EAAK7B,oBAAoB+B,SAAnG,OAEZ,EAAKlC,QAAS,EACd,EAAK1B,aAAe,GACpB,EAAKsB,QACL,MACF,IAAK,gBACH,EAAKI,QAAS,EACd,EAAKrC,aAAaqE,EAAKG,KAAMH,EAAKnE,EAAGmE,EAAKlE,GAAG,GAC7C,IAAMsE,EAAW,EAAKlC,MAAMa,MAAMiB,EAAKG,MAAM,GAAG,EAChD,EAAK/B,UAAS,SAACiC,GAAD,MAAgB,CAC5BlC,kBAAmB6B,EAAKM,WACxBvB,MAAM,2BAAKsB,EAAUtB,OAAUqB,GAC/BpB,SAAUgB,EAAKhB,SACfX,WAAW,+HAAD,OAA6B,EAAK3C,MAAMuD,QAAQ,EAAKvD,MAAMa,SAASiD,MAAMQ,EAAKG,OAAOD,cAClG,MACF,IAAK,OACH,EAAK9B,SAAS,CAACD,kBAAmB6B,EAAKM,WAAYtB,SAAUgB,EAAKhB,SAAUX,WAAW,2DAAD,OAAgB,EAAK3C,MAAMuD,QAAQ,EAAKvD,MAAMa,SAASiD,MAAMQ,EAAKM,aAAaJ,YACrK,EAAKvE,aAAaqE,EAAKG,KAAMH,EAAKnE,EAAGmE,EAAKlE,GAAG,GAC7C,MACF,IAAK,QACH,EAAKH,aAAaqE,EAAKG,KAAMH,EAAKnE,EAAGmE,EAAKlE,GAC1C,MACF,IAAK,gBACH,EAAKsC,SAAS,CAACC,WAAW,yHAAD,OAA4B,EAAK3C,MAAMuD,QAAQ,EAAKvD,MAAMa,SAASiD,MAAMQ,EAAK7B,oBAAoB+B,YAC3H,MACF,IAAK,aACC,EAAKhC,MAAMC,oBAAoB,EAAKF,aAAc,EAAKG,SAAS,CAACC,WAAY,iGAC5E,EAAKD,SAAS,CAACC,WAAY,+HAChC,EAAKD,SAAS,CAACD,kBAAmB6B,EAAKM,WAAYtB,SAAUgB,EAAKhB,iB,0CAQtE,IAAK,IAAIuB,KADTV,KAAKjC,QACkBiC,KAAKvD,aAC1BuD,KAAKlE,aAAakE,KAAKvD,aAAaiE,GAAaA,EAAWV,KAAKnE,MAAMa,SAASC,aAAc+D,EAAWV,KAAKnE,MAAMa,SAASC,c,6CAIjIqD,KAAKC,qB,+BA+GH,OACM,qCACE,cAACU,EAAA,EAAD,CAAYC,sBAAsB,EAChCzC,OAAQ6B,KAAK7B,OACbwB,MAAOK,KAAKnE,MAAMa,SAASiD,MAC3BP,QAASY,KAAKnE,MAAMuD,QACpBd,kBAAmB0B,KAAK3B,MAAMC,kBAC9BF,aAAc4B,KAAK5B,aACnByC,SAAUb,KAAKnE,MAAMa,SAASmE,SAC9B1B,SAAUa,KAAK3B,MAAMc,SACrBD,MAAOc,KAAK3B,MAAMa,MAClB4B,eAAgB,CAAC,8BAEnB,cAACC,EAAA,EAAD,CAAWC,UAAWC,IAAOC,KAC3Bf,KAAM,CACJ,CAAC,6CAAWH,KAAKnE,MAAMa,SAASyE,cAChC,CAAC,sEAAgBnB,KAAKnE,MAAMa,SAASC,WACrC,CAAC,iEAAgBqD,KAAKnE,MAAMa,SAASmE,SAAS,KAC9C,CAAC,yFAAoBb,KAAKnE,MAAMa,SAAS0E,gBAG7C,cAACC,EAAA,EAAD,CAAOtF,MAAOiE,KAAK3B,MAAMG,aAEzB,sBAAKwC,UAAWC,IAAO7E,OAAvB,UACE,wBAAQkF,IAAKtB,KAAK5D,OAChBmF,QAASvB,KAAK/B,WACduD,MAAwC,IAA/BxB,KAAKnE,MAAMa,SAASC,UAAc,EAC3C8E,OAAyC,IAA/BzB,KAAKnE,MAAMa,SAASC,UAAc,IAC9C,cAAC+E,EAAA,EAAD,CAAOV,UAAWC,IAAOU,MACvBC,OAAQ5B,KAAKnE,MAAMa,SAASC,UAC5BkF,OAAQ7B,KAAKnE,MAAMa,SAASC,sB,GAjNPmD,IAAMgC,Y,sJCIxBnB,E,kDACnB,WAAY9E,GAAQ,IAAD,8BACjB,cAAMA,IAkBRkG,eAAiB,WACf,IAAMC,EAAqB,GAC3B,QAAuBC,IAAnB,EAAKpG,MAAM8D,MAAkB,CAAC,IAAD,gBACL,EAAK9D,MAAM8D,OADN,IAC/B,2BAA4C,CAAC,IAApCuC,EAAmC,QAC1CF,EAAmBG,KAAK,EAAKtG,MAAMuD,QAAQ8C,KAFd,oCAI1BE,MAAMC,UAAUF,KAAKG,MAAMN,EAAmB,EAAKnG,MAAMuD,SAEhE,OAAO4C,EAAmBO,KAAI,SAACjD,EAAQC,GAAT,OAC9B,sBAAKiD,MAAO,CAACC,MAAQnD,EAAOoD,UAA6B,EAAK7G,MAAMuC,eAAemB,EAAM,iBAAiB,OAApE,oBAAtC,UACE,gCACE,8BAAMA,EAAM,IACZ,oCAAOD,EAAOE,UACd,8BAAMF,EAAOe,cAEd,EAAKxE,MAAMqD,MAAMK,GAAOgD,KAAI,SAAAI,GAAI,OACjC,8BAAMA,cAjCR,EAAKtE,MAAQ,CACXuE,aAAc/G,EAAMgF,SAAWhF,EAAMsD,SAAW0D,KAAKC,OAAO,MAE9D,EAAKC,qBAAkBd,EALN,E,gEAOE,IAAD,OAEdjC,KAAKnE,MAAM+E,uBAAsBZ,KAAK+C,gBAAkBC,aAAY,WACtE,IAAK,EAAK7E,OAAQ,CAChB,IAAM8E,MAAkB,EAAKpH,MAAMgF,SAAW,EAAKhF,MAAMsD,SAAW0D,KAAKC,OAAO,KAChF,EAAKvE,SAAS,CAACqE,SAAUK,OAE1B,Q,6CAGCjD,KAAKnE,MAAM+E,sBAAsBsC,cAAclD,KAAK+C,mB,+BAwBxD,IAAMI,EAAU,cAAU,IAAMnD,KAAK3B,MAAMuE,UAAU5C,KAAKnE,MAAMgF,SAAS,KAAM,IAA/D,aAAuEb,KAAK3B,MAAMuE,UAAU5C,KAAKnE,MAAMgF,SAAS,KAAM,IAAtH,QACd,OACQ,sBAAKG,UAAWC,IAAO/B,MAAvB,UACE,gCACE,uEACCc,KAAKnE,MAAMiF,eAAeyB,KAAI,SAAAa,GAAQ,OACrC,8BAAMA,UAGTpD,KAAKnE,MAAM+E,qBACZ,sBAAKI,UAAWC,IAAOoC,mBAAoBb,MAAO,CAACC,MAAOU,EAAYrE,IAAK,GAAkC,GAA7BkB,KAAKnE,MAAMyC,kBAAqB,KAAMgF,gBAAiBH,GAAvI,UACE,8BAAMnD,KAAK3B,MAAMuE,WACjB,qBAAKJ,MAAO,CAAC,eAAgBW,KAC7B,qBAAKX,MAAO,CAAC,eAAgBW,QAE9B,wBAGAnD,KAAK+B,wB,GA5DkBjC,IAAMgC,Y,mBCb9CyB,EAAOC,QAAU,CAAC,MAAQ,qBAAqB,mBAAqB,oC,8ICE/CnC,E,kDACnB,WAAYxF,GAAQ,IAAD,8BACjB,cAAMA,IAIR4H,sBAAwB,SAACC,GACvB,OAAIA,EAAU3H,QAAQ,EAAKF,MAAME,QACjC,EAAK4H,cAAe,OACW1B,IAA3B,EAAK2B,qBACPC,aAAa,EAAKD,qBAEpB,EAAKA,oBAAsBE,YAAW,WACpC,EAAKH,cAAe,EACpB,EAAKC,yBAAsB3B,EAC3B,EAAK8B,gBACJ,MACI,IAhBU,EAkBnBC,UAAY,WACVH,aAAa,EAAKD,qBAClB,EAAKD,cAAe,EACpB,EAAKC,yBAAsB3B,EAC3B,EAAK8B,eApBL,EAAKJ,cAAe,EACpB,EAAKC,yBAAsB3B,EAHV,E,qDAyBjB,OACE,qBAAKjB,UAAS,UAAKC,IAAOgD,MAAZ,YAAqBjE,KAAK2D,aAAa1C,IAAO0C,aAAa,IAAzE,SACE,qBAAKpC,QAASvB,KAAKgE,UAAnB,SACGhE,KAAKnE,MAAME,c,GA7Ba+D,IAAMgC,Y,mBCFzCyB,EAAOC,QAAU,CAAC,MAAQ,qBAAqB,aAAe,8B,kFCA/C,SAAS9B,EAAM7F,GAC5B,SAASqI,EAAgBC,GAEvB,IADA,IAAIC,EAAU,GACNpG,EAAI,EAAGA,EAAImG,EAAQnG,IACzBoG,EAAQjC,KAAK,wBAEf,OAAOiC,EAET,OACE,sBAAKpD,UAAWnF,EAAMmF,UAAtB,UACI,6BACGkD,EAAgBrI,EAAMgG,UAEzB,6BACGqC,EAAgBrI,EAAM+F,UAEzB,8BACE,0BAEF,wBACA,6B,kFCpBO,SAASb,EAAUlF,GAChC,OACE,qBAAKmF,UAAWnF,EAAMmF,UAAtB,SACGnF,EAAMsE,KAAKoC,KAAI,SAAAI,GAAI,OAAI,gCAAK,+BAAOA,EAAK,KAAU,qCAAQA,EAAK,gB,mBCHtEY,EAAOC,QAAU,CAAC,OAAS,uBAAuB,MAAQ,sBAAsB,KAAO,qBAAqB,QAAU","file":"static/js/7.e5da64f2.chunk.js","sourcesContent":["//animRenderF принимает значение времени с начала анимации\r\nfunction animate(animRenderF, time) {\r\n  let animStart = null\r\n  const animStep = timestamp => {\r\n    if (!animStart) animStart=timestamp\r\n    const animCurrentTime = timestamp - animStart\r\n    animRenderF(animCurrentTime)\r\n    if (animCurrentTime<time) window.requestAnimationFrame(animStep)\r\n  }      \r\n  window.requestAnimationFrame(animStep)\r\n}\r\nexport {animate}","export default __webpack_public_path__ + \"static/media/pencil.29250349.mp3\";","import React from 'react'\r\nimport Scoreboard from '../parts/Scoreboard'\r\nimport Alert from '../parts/Alert'\r\nimport Ruler from '../parts/Ruler'\r\nimport InfoBlock from '../parts/InfoBlock'\r\nimport {animate} from '../parts/CanvasTools'\r\nimport soundPencil from '../../static/sound/pencil.mp3'\r\n\r\nimport styles from '../../static/css/canvas.module.css'\r\n\r\nexport default class Tictactoe extends React.Component {\r\n  constructor(props) {\r\n    super(props) \r\n    this.state = {\r\n\t\t\tcurrentPlayerTurn: props.gameInfo.currentPlayerTurn,\r\n      score: props.gameInfo.score,\r\n      alertValue: \"\", \r\n      lasttime: props.gameInfo.lasttime\r\n    }\r\n    this.currentBoard = props.gameInfo.currentBoard\r\n    this.paused = props.gameInfo.paused\r\n    props.players.every((player, index) => player.userId!== localStorage.getItem('userId')?true:props.gameInfo.queue.every((queuePlayer, queueIndex) => {\r\n        if (queuePlayer===index) {\r\n        this.playerNumber = queueIndex\r\n        return false\r\n      } else return true\r\n    }))\r\n    this.canvas = React.createRef()\r\n  }\r\n  componentWillMount() {\r\n    this.emitterUnsubGame = this.props.emitter.sub('game', data => {\r\n      switch(data.type) {\r\n        case 'roundStarted': \r\n          this.setState({\r\n            currentPlayerTurn: data.currentPlayerTurn,\r\n            lasttime: data.lasttime,\r\n            alertValue: `Раунд начинается c хода ${this.props.players[this.props.gameInfo.queue[data.currentPlayerTurn]].userName}!`\r\n          })\r\n          this.paused = false\r\n          this.currentBoard = {}\r\n          this.clear()\r\n          break\r\n        case 'roundFinished': \r\n          this.paused = true\r\n          this.displayPoint(data.cell, data.x, data.y, true)\r\n          const newScore = this.state.score[data.cell][0]+1\r\n          this.setState((prevState) => ({\r\n            currentPlayerTurn: data.nextPlayer, \r\n            score: {...prevState.score, ...newScore}, \r\n            lasttime: data.lasttime, \r\n            alertValue: `Раунд завершён! Победил ${this.props.players[this.props.gameInfo.queue[data.cell]].userName}`}))\r\n          break\r\n        case 'turn': \r\n          this.setState({currentPlayerTurn: data.nextPlayer, lasttime: data.lasttime, alertValue: `Ход игрока ${this.props.players[this.props.gameInfo.queue[data.nextPlayer]].userName}`})\r\n          this.displayPoint(data.cell, data.x, data.y, true)\r\n          break\r\n        case 'error': \r\n          this.displayPoint(data.cell, data.x, data.y)\r\n          break\r\n        case 'matchFinished': \r\n          this.setState({alertValue: `Матч завершён. Победил ${this.props.players[this.props.gameInfo.queue[data.currentPlayerTurn]].userName}`})\r\n          break\r\n        case 'nextPlayer': \r\n          if (this.state.currentPlayerTurn===this.playerNumber) this.setState({alertValue: 'Вы пропустили ход'})\r\n          else this.setState({alertValue: 'Оппонент пропустил ход'})\r\n          this.setState({currentPlayerTurn: data.nextPlayer, lasttime: data.lasttime})\r\n          break\r\n        default: break\r\n      }\r\n    })\r\n  }\r\n  componentDidMount() {\r\n      this.clear()\r\n      for (let cellNumber in this.currentBoard) {\r\n        this.displayPoint(this.currentBoard[cellNumber], cellNumber%this.props.gameInfo.boardSize, ~~(cellNumber/this.props.gameInfo.boardSize))\r\n      }\r\n  }\r\n  componentWillUnmount() {\r\n    this.emitterUnsubGame()\r\n  }\r\n\r\n  displayPoint = (value, x, y, animation=false) => {\r\n    const ctx = this.canvas.current.getContext('2d')\r\n    ctx.lineCap = \"round\"\r\n    ctx.lineWidth = 3\r\n    this.currentBoard[this.props.gameInfo.boardSize*y + x] = value\r\n    const turnSound = new Audio(soundPencil)\r\n    turnSound.play()\r\n    if (animation===true) {\r\n      switch (value) {\r\n        case 0: \r\n          animate(timestamp => {\r\n            ctx.fillStyle = `rgba(200,200,255, ${timestamp<1000?timestamp/1000:timestamp>2000?1-(timestamp-2000)/1000:1})`\r\n            ctx.strokeStyle = \"blue\"\r\n            ctx.clearRect(x*30+1, y*30+1, 28, 28)\r\n            ctx.fillRect(x*30+1, y*30+1, 28, 28)\r\n            ctx.fill()\r\n            ctx.beginPath()\r\n            const coordFirstLine = Math.floor((timestamp<300?timestamp:300)/16)\r\n            ctx.moveTo(x*30+6, y*30+6)\r\n            ctx.lineTo(x*30+6+coordFirstLine, y*30+6+coordFirstLine)\r\n            if (timestamp>300) {\r\n              const coordSecondLine = Math.floor((timestamp<600?timestamp-300:300)/16)\r\n              ctx.moveTo(x*30+24, y*30+6)\r\n              ctx.lineTo(x*30+24-coordSecondLine, y*30+6+coordSecondLine)\r\n            }\r\n            ctx.stroke()\r\n          }, 3000)\r\n        break\r\n        case 1: \r\n          animate(timestamp => {\r\n            ctx.fillStyle = `rgba(255,200,200, ${timestamp<1000?timestamp/1000:timestamp>2000?1-(timestamp-2000)/1000:1})`\r\n            ctx.strokeStyle = \"red\"\r\n            ctx.clearRect(x*30+1, y*30+1, 28, 28)\r\n            ctx.fillRect(x*30+1, y*30+1, 28, 28)\r\n            ctx.fill()\r\n            ctx.beginPath()\r\n            ctx.arc(x*30+15, y*30+15, 9, 0,-Math.PI*(timestamp<600?timestamp/300:2), true)\r\n            ctx.stroke()\r\n          }, 3000)\r\n        break\r\n        case 2: \r\n          animate(timestamp => {\r\n            ctx.fillStyle = `rgba(200,255,200, ${timestamp<1000?timestamp/1000:timestamp>2000?1-(timestamp-2000)/1000:1})`\r\n            ctx.clearRect(x*30+1, y*30+1, 28, 28)\r\n            ctx.fillRect(x*30+1, y*30+1, 28, 28)\r\n            ctx.fill()\r\n            ctx.fillStyle = \"green\"\r\n            ctx.beginPath()\r\n            ctx.arc(x*30+15, y*30+15, timestamp<600?timestamp/85:7, 0, Math.PI*2, true)\r\n            ctx.fill()\r\n          }, 3000)\r\n        break\r\n        default: break\r\n      }\r\n    } else {\r\n      switch (value) {\r\n        case 0: \r\n          ctx.beginPath()\r\n          ctx.moveTo(x*30+6, y*30+6)\r\n          ctx.lineTo(x*30+24, y*30+24)\r\n          ctx.moveTo(x*30+24, y*30+6)\r\n          ctx.lineTo(x*30+6, y*30+24)\r\n          ctx.strokeStyle = \"blue\"\r\n          ctx.stroke()\r\n        break\r\n        case 1: \r\n          ctx.beginPath()\r\n          ctx.arc(x*30+15, y*30+15, 9, 0, Math.PI * 2, true)\r\n          ctx.strokeStyle = \"red\"\r\n          ctx.stroke()\r\n        break\r\n        case 2: \r\n          ctx.beginPath()\r\n          ctx.arc(x*30+15, y*30+15, 7, 0, Math.PI * 2, true)\r\n          ctx.fillStyle = \"green\"\r\n          ctx.fill()\r\n        break\r\n        default: break\r\n      }\r\n    }\r\n  }\r\n  clear = () => {\r\n    const ctx = this.canvas.current.getContext('2d')\r\n    ctx.clearRect(0,0,(this.props.gameInfo.boardSize+1)*30, (this.props.gameInfo.boardSize+1)*30)\r\n    ctx.strokeStyle = '#000'\r\n    ctx.lineWidth = 1\r\n    ctx.beginPath();\r\n    for(let i = 0; i <= this.props.gameInfo.boardSize; i++) {\r\n      ctx.moveTo(i*30, 0)\r\n      ctx.lineTo(i*30, this.props.gameInfo.boardSize*30)\r\n    }\r\n    for(let i = 0; i <= this.props.gameInfo.boardSize; i++) {\r\n      ctx.moveTo(0, i*30)\r\n      ctx.lineTo(this.props.gameInfo.boardSize*30, i*30)\r\n    }\r\n    ctx.stroke()\r\n\r\n  }\r\n  actionTurn = (e) => {\r\n    if (this.paused||this.playerNumber!==this.state.currentPlayerTurn) return this.setState({alertValue: 'Сейчас очередь оппонента'})\r\n    const rect = this.canvas.current.getBoundingClientRect();\r\n    const x = ~~((e.clientX - rect.left)/30);\r\n    const y = ~~((e.clientY - rect.top)/30);\r\n    if (!this.currentBoard.hasOwnProperty(y*+this.props.gameInfo.boardSize+x)) {\r\n      this.props.emitter.emit('action', {x: x, y: y})\r\n    } else this.setState({alertValue: 'Ячейка занята'})\r\n  }\r\n  render() {\r\n      return (\r\n            <>\r\n              <Scoreboard displayCurrentPlayer={true}\r\n                paused={this.paused}\r\n                queue={this.props.gameInfo.queue} \r\n                players={this.props.players} \r\n                currentPlayerTurn={this.state.currentPlayerTurn} \r\n                playerNumber={this.playerNumber}\r\n                timeTurn={this.props.gameInfo.timeTurn} \r\n                lasttime={this.state.lasttime}\r\n                score={this.state.score}\r\n                scoreItemNames={['Счёт']} />\r\n\r\n              <InfoBlock className={styles.info} \r\n                data={[\r\n                  ['Раундов', this.props.gameInfo.roundsForWin], \r\n                  ['Размер доски', this.props.gameInfo.boardSize], \r\n                  ['Время на ход', this.props.gameInfo.timeTurn/1000], \r\n                  ['Ячеек для победы', this.props.gameInfo.cellsForWin], \r\n                ]}\r\n              />\r\n              <Alert value={this.state.alertValue} />\r\n              \r\n              <div className={styles.canvas}>\r\n                <canvas ref={this.canvas} \r\n                  onClick={this.actionTurn} \r\n                  width={(+this.props.gameInfo.boardSize)*30+1} \r\n                  height={(+this.props.gameInfo.boardSize)*30+1} /> \r\n                <Ruler className={styles.ruler}  \r\n                  countY={this.props.gameInfo.boardSize}\r\n                  countX={this.props.gameInfo.boardSize} />\r\n              </div>\r\n            </>\r\n      )\r\n  }\r\n}\r\n","import React from 'react'\r\nimport styles from '../../static/css/score.module.css'\r\n/*\r\n  displayCurrentPlayer - Выделить текущего игрока\r\n  paused - Останавливает/Включает таймер\r\n  queue - Последовательность игроков к которым применяется\r\n  players - Массив игроков ex: [{\"userId\":\"11\", \"userName\": \"eeee\r\n  currentPlayerTurn - Текщий игрок\r\n  playerNumber - Игрок (не ставить если гость)\r\n  timeTurn - Время на совершение хода \r\n  lasttime - Время начала хода ()\r\n  score - Счёт ex: [[0,0,0], [1,0,0]]\r\n  scoreItemNames - Названия столбцов ex: ['Счёт', 'Осталось', 'Найдено']\r\n*/\r\nexport default class Scoreboard extends React.Component {\r\n  constructor(props) {\r\n    super(props) \r\n    this.state = {\r\n      timeleft: ~~((props.timeTurn + props.lasttime - Date.now())/1000),\r\n    }\r\n    this.playerTurnTimer = undefined\r\n  }\r\n  componentDidMount() {\r\n    //Отображение оставшегося времени у игрока\r\n    if (this.props.displayCurrentPlayer) this.playerTurnTimer = setInterval(() => {\r\n      if (!this.paused) {\r\n        const newTimeleft = ~~((this.props.timeTurn + this.props.lasttime - Date.now())/1000)\r\n        this.setState({timeleft: newTimeleft})\r\n      }\r\n    }, 1000)\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.props.displayCurrentPlayer) clearInterval(this.playerTurnTimer)\r\n  }\r\n  getPlayersList = () => {\r\n    const sortedPlayersArray = []\r\n    if (this.props.queue!==undefined){\r\n      for (let numberInQueue of this.props.queue) {\r\n        sortedPlayersArray.push(this.props.players[numberInQueue])\r\n      }\r\n    } else Array.prototype.push.apply(sortedPlayersArray,this.props.players)\r\n    \r\n    return sortedPlayersArray.map((player, index) => \r\n    <div style={{color: !player.connected?\"rgb(150,150,150)\":this.props.playerNumber===index?\"rgb(255,165,0)\":\"#000\"}}>\r\n      <div>\r\n        <div>{index+1}</div>\r\n        <div>#{player.userId}</div>\r\n        <div>{player.userName}</div>\r\n      </div>\r\n      {this.props.score[index].map(prop=>\r\n      <div>{prop}</div>\r\n      )}\r\n    </div>\r\n    )\r\n  }\r\n  render() {\r\n    const scoreColor = `rgb(${255 - this.state.timeleft/(this.props.timeTurn/1000)*255}, ${this.state.timeleft/(this.props.timeTurn/1000)*200}, 0)`\r\n      return (\r\n              <div className={styles.score}>\r\n                <div>\r\n                  <div>Игроки</div>\r\n                  {this.props.scoreItemNames.map(itemName=>\r\n                    <div>{itemName}</div>\r\n                    )}\r\n                </div>\r\n                {this.props.displayCurrentPlayer?\r\n                <div className={styles.scoreCurrentPlayer} style={{color: scoreColor, top: 30 + this.props.currentPlayerTurn*42+'px', backgroundColor: scoreColor}}>\r\n                  <div>{this.state.timeleft}</div>\r\n                  <div style={{\"border-color\": scoreColor}}></div>\r\n                  <div style={{\"border-color\": scoreColor}}></div>\r\n                </div>\r\n                :<div></div>\r\n                }\r\n                \r\n                {this.getPlayersList()}\r\n              </div>\r\n      )\r\n  }\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"score\":\"score_score__1Slqo\",\"scoreCurrentPlayer\":\"score_scoreCurrentPlayer__36TAD\"};","import React from 'react'\r\nimport styles from '../../static/css/alert.module.css'\r\n\r\nexport default class Alert extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.alertDisplay = false\r\n    this.alertTimeoutDestroy = undefined\r\n  }\r\n  shouldComponentUpdate = (nextProps) => {\r\n    if (nextProps.value===this.props.value) return false\r\n    this.alertDisplay = true\r\n    if (this.alertTimeoutDestroy!==undefined) {\r\n      clearTimeout(this.alertTimeoutDestroy)\r\n    }\r\n    this.alertTimeoutDestroy = setTimeout(() => {\r\n      this.alertDisplay = false\r\n      this.alertTimeoutDestroy = undefined\r\n      this.forceUpdate()\r\n    }, 3000)\r\n    return true\r\n  }\r\n  alertHide = () => {\r\n    clearTimeout(this.alertTimeoutDestroy)\r\n    this.alertDisplay = false\r\n    this.alertTimeoutDestroy = undefined\r\n    this.forceUpdate()\r\n  }\r\n  render() {\r\n    return (\r\n      <div className={`${styles.alert} ${this.alertDisplay?styles.alertDisplay:''}`}>\r\n        <div onClick={this.alertHide}>\r\n          {this.props.value}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"alert\":\"alert_alert__285A5\",\"alertDisplay\":\"alert_alertDisplay__3muLT\"};","import React from 'react'\r\nexport default function Ruler(props) {\r\n  function getListByLength(length) {\r\n    let section = []\r\n    for(let i = 0; i < length; i++) {\r\n      section.push(<li></li>)\r\n    }\r\n    return section\r\n  }\r\n  return (\r\n    <div className={props.className} >\r\n        <ol>\r\n          {getListByLength(props.countX)}\r\n        </ol>\r\n        <ol>\r\n          {getListByLength(props.countY)}\r\n        </ol>\r\n        <div>\r\n          <div></div>\r\n        </div>\r\n        <div></div>\r\n        <div></div>\r\n    </div>\r\n  )\r\n}","import React from 'react'\r\nexport default function InfoBlock(props) {\r\n  return (\r\n    <div className={props.className} >\r\n      {props.data.map(prop => <div><span>{prop[0]}</span><span> {prop[1]}</span></div>) }\r\n    </div>\r\n  )\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"canvas_canvas__1xjwk\",\"ruler\":\"canvas_ruler__3jpTN\",\"info\":\"canvas_info__larj0\",\"ruler24\":\"canvas_ruler24__2YnvR\"};"],"sourceRoot":""}